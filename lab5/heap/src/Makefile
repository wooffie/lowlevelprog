# Все файлы с исходным кодом на СИ будут перечисленны в данной переменной

SRCS = ${wildcard *.c}

# Объектные файлы необходимые для постройки библотеки
# main.o не включается, потому что это файл для консольной программы

OBJS = ${filter-out main.o,${SRCS:.c=.o}}

# Главный рецепт (т.к. первый)
# Необходимо собрать библотеку, для этого нужны скопилированные объектные файлы

lib$(NAME).a: $(OBJS)
	$(AR) $(ARFLAGS) $@ $^

# Рецепт для сборки программы, необходимо собрать библиотеку и мейн
# Перемещает exe в корневую папку проекта для удобства

$(NAME): main.o lib$(NAME).a
	$(CC) $(CFLAGS) $^ -o $@
	move $(NAME).exe ../

# Основной рецепт для получения объектный файлов
# Main.o будет получен, т.к. указан в зависимостях цели $(NAME)
%.o: %.c
	gcc $(CFLAGS) $(INCLUDES) -c -o $@ $<

.PHONY: clean

# Цель очистки от файлов полученных в ходе работы компилятора

clean:
	-$(RM) *.o *.a